# üèó –£—Ä–æ–∫ 3: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## üéØ –¶–µ–ª–∏ —É—Ä–æ–∫–∞

–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞ –≤—ã —Å–º–æ–∂–µ—Ç–µ:
- ‚úÖ –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –í—ã–±–∏—Ä–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ
- ‚úÖ –û–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –û—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

## üìñ –ß—Ç–æ —Ç–∞–∫–æ–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞?

!!! quote "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤"
    **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —ç—Ç–æ –ø–æ–¥—Ö–æ–¥ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ç—Ä–æ–∏—Ç—Å—è –∫–∞–∫ –Ω–∞–±–æ—Ä –Ω–µ–±–æ–ª—å—à–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å–≤–æ–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –¥—Ä—É–≥–∏–º–∏ —á–µ—Ä–µ–∑ —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ API.

### üí° –ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏

**–ê–Ω–∞–ª–æ–≥–∏—è**: –†–∞–π–æ–Ω —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –¥–æ–º–∞–º–∏
- –ö–∞–∂–¥—ã–π –¥–æ–º (—Å–µ—Ä–≤–∏—Å) –Ω–µ–∑–∞–≤–∏—Å–∏–º –∏ –∞–≤—Ç–æ–Ω–æ–º–µ–Ω
- –£ –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ–π –∞–¥—Ä–µ—Å (API endpoint)
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç—å –æ–¥–∏–Ω –¥–æ–º, –Ω–µ —Ç—Ä–æ–≥–∞—è –¥—Ä—É–≥–∏–µ
- –ù–æ –Ω—É–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –¥–æ—Ä–æ–≥–∏ –º–µ–∂–¥—É –¥–æ–º–∞–º–∏ (—Å–µ—Ç—å, –æ—á–µ—Ä–µ–¥–∏)
- –ö–∞–∂–¥—ã–π –¥–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ-—Ä–∞–∑–Ω–æ–º—É (—Ä–∞–∑–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)

**–í –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏:**
- –ù–µ–±–æ–ª—å—à–∏–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å - —Å–≤–æ—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ API
- –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

```mermaid
graph TB
    A[API Gateway] --> B[User Service<br/>Python/FastAPI]
    A --> C[Order Service<br/>Python/FastAPI]
    A --> D[Payment Service<br/>Java/Spring]
    A --> E[Notification Service<br/>Node.js]
    
    B --> F[PostgreSQL]
    C --> G[PostgreSQL]
    D --> H[MongoDB]
    E --> I[Redis]
    
    B -.->|HTTP/gRPC| C
    C -.->|HTTP/gRPC| D
    D -.->|Events| E
    
    style A fill:#4dabf7
    style B fill:#51cf66
    style C fill:#51cf66
    style D fill:#ffd43b
    style E fill:#ff6b6b
```

### –ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

1. **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ** - –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
2. **–ê–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥** - —Ä–∞–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞–¥ —Ä–∞–∑–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
3. **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –≥–∏–±–∫–æ—Å—Ç—å** - —Ä–∞–∑–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - —Å–µ—Ä–≤–∏—Å—ã –º–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
5. **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** - —Å–±–æ–π –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –≤—Å—é —Å–∏—Å—Ç–µ–º—É

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. **–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å** (Single Responsibility)

```python
# ‚ùå –ü–ª–æ—Ö–æ: –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
class OrderService:
    def create_order(self, order_data):
        # –í–∞–ª–∏–¥–∞—Ü–∏—è
        # –†–∞—Å—á–µ—Ç —Ü–µ–Ω—ã
        # –°–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤
        # –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        pass

# ‚úÖ –•–æ—Ä–æ—à–æ: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
# Order Service - —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏
# Payment Service - —Ç–æ–ª—å–∫–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
# Notification Service - —Ç–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
# Inventory Service - —Ç–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∞—Å–∞–º–∏
```

### 2. **–ê–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤** (Service Autonomy)

```python
# –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å:
# - –ò–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
# - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
# - –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
# - –ò–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª
```

### 3. **API –∫–∞–∫ –∫–æ–Ω—Ç—Ä–∞–∫—Ç** (API as Contract)

```python
# API-first –ø–æ–¥—Ö–æ–¥
# OpenAPI/Swagger —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
# –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API
# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫–∞–∫ —á–∞—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```

### 4. **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** (Resilience)

```python
# Circuit Breaker –ø–∞—Ç—Ç–µ—Ä–Ω
# Retry –ª–æ–≥–∏–∫–∞
# Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
# Graceful degradation
```

## üîç –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

### –®–∞–≥ 1: –ê–Ω–∞–ª–∏–∑ –¥–æ–º–µ–Ω–∞ (Domain Analysis)

#### –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π (Business Capabilities)

```
üìä E-commerce Domain
‚îú‚îÄ‚îÄ üõí Product Management
‚îÇ   ‚îú‚îÄ‚îÄ Product Catalog
‚îÇ   ‚îú‚îÄ‚îÄ Product Search
‚îÇ   ‚îú‚îÄ‚îÄ Product Reviews
‚îÇ   ‚îî‚îÄ‚îÄ Product Recommendations
‚îú‚îÄ‚îÄ üë• Customer Management
‚îÇ   ‚îú‚îÄ‚îÄ Customer Registration
‚îÇ   ‚îú‚îÄ‚îÄ Customer Profiles
‚îÇ   ‚îú‚îÄ‚îÄ Customer Preferences
‚îÇ   ‚îî‚îÄ‚îÄ Customer History
‚îú‚îÄ‚îÄ üõçÔ∏è Order Management
‚îÇ   ‚îú‚îÄ‚îÄ Order Creation
‚îÇ   ‚îú‚îÄ‚îÄ Order Processing
‚îÇ   ‚îú‚îÄ‚îÄ Order Tracking
‚îÇ   ‚îî‚îÄ‚îÄ Order History
‚îú‚îÄ‚îÄ üí∞ Payment Processing
‚îÇ   ‚îú‚îÄ‚îÄ Payment Methods
‚îÇ   ‚îú‚îÄ‚îÄ Payment Processing
‚îÇ   ‚îú‚îÄ‚îÄ Refunds
‚îÇ   ‚îî‚îÄ‚îÄ Payment History
‚îî‚îÄ‚îÄ üì¶ Inventory Management
    ‚îú‚îÄ‚îÄ Stock Tracking
    ‚îú‚îÄ‚îÄ Stock Reservations
    ‚îú‚îÄ‚îÄ Stock Alerts
    ‚îî‚îÄ‚îÄ Stock Optimization
```

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü —Å–µ—Ä–≤–∏—Å–æ–≤ (Bounded Contexts)

```python
# Product Service
class ProductService:
    def create_product(self, product_data):
        # –¢–æ–ª—å–∫–æ –ø—Ä–æ–¥—É–∫—Ç—ã
        pass

    def update_product(self, product_id, updates):
        # –¢–æ–ª—å–∫–æ –ø—Ä–æ–¥—É–∫—Ç—ã
        pass

    def search_products(self, query):
        # –¢–æ–ª—å–∫–æ –ø—Ä–æ–¥—É–∫—Ç—ã
        pass

# Order Service
class OrderService:
    def create_order(self, order_data):
        # –¢–æ–ª—å–∫–æ –∑–∞–∫–∞–∑—ã
        pass

    def get_order(self, order_id):
        # –¢–æ–ª—å–∫–æ –∑–∞–∫–∞–∑—ã
        pass

    def update_order_status(self, order_id, status):
        # –¢–æ–ª—å–∫–æ –∑–∞–∫–∞–∑—ã
        pass
```

### –®–∞–≥ 2: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è

#### –†–∞–∑–º–µ—Ä —Å–µ—Ä–≤–∏—Å–∞ (Service Size)

```python
# –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞:
# - 100-1000 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
# - 1-2 —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
# - 1-2 –Ω–µ–¥–µ–ª–∏ –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É
# - –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

# –ü—Ä–∏–∑–Ω–∞–∫–∏ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
# - –¢—Ä—É–¥–Ω–æ –ø–æ–Ω—è—Ç—å –≤–µ—Å—å –∫–æ–¥
# - –î–æ–ª–≥–æ–µ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏/—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
# - –ú–Ω–æ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
# - –†–µ–¥–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç—è—Ö

# –ü—Ä–∏–∑–Ω–∞–∫–∏ —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
# - –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–æ–≤
# - –°–ª–æ–∂–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è
# - Overhead –Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
# - –¢—Ä—É–¥–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏

1. **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞** - —Å–µ—Ä–≤–∏—Å—ã –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±–∏–∑–Ω–µ—Å-–¥–æ–º–µ–Ω–∞–º
2. **–ß–∞—Å—Ç–æ—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π** - —á–∞—Å—Ç–æ –∏–∑–º–µ–Ω—è—é—â–∏–µ—Å—è —á–∞—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö
3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - —Ä–∞–∑–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω–∞–≥—Ä—É–∑–∫–µ
4. **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏** - —Ä–∞–∑–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
5. **–ö–æ–º–∞–Ω–¥—ã** - –≥—Ä–∞–Ω–∏—Ü—ã –≤–ª–∞–¥–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–∞–º–∏

## üîó –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

### –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

#### REST API (HTTP)

```python
# Product Service API
from fastapi import FastAPI
from pydantic import BaseModel

app = FastAPI(title="Product Service", version="1.0.0")

class ProductResponse(BaseModel):
    id: int
    name: str
    price: float
    category: str

@app.get("/products/{product_id}", response_model=ProductResponse)
async def get_product(product_id: int):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏–∑ –ë–î
    return ProductResponse(
        id=product_id,
        name="Sample Product",
        price=99.99,
        category="Electronics"
    )

# Order Service –≤—ã–∑—ã–≤–∞–µ—Ç Product Service
import httpx

class OrderService:
    def __init__(self):
        self.client = httpx.AsyncClient()

    async def validate_order_items(self, order_data):
        for item in order_data['items']:
            # –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
            response = await self.client.get(
                f"http://product-service/products/{item['product_id']}"
            )
            if response.status_code != 200:
                raise ValueError(f"Product {item['product_id']} not found")

            product = response.json()
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏, —Ü–µ–Ω—ã –∏ —Ç.–¥.
```

#### gRPC

```protobuf
// product.proto
service ProductService {
  rpc GetProduct (GetProductRequest) returns (ProductResponse);
  rpc GetProducts (GetProductsRequest) returns (ProductsResponse);
}

message Product {
  int32 id = 1;
  string name = 2;
  float price = 3;
  string category = 4;
}
```

```python
# Python –∫–ª–∏–µ–Ω—Ç –¥–ª—è gRPC
import grpc
import product_pb2
import product_pb2_grpc

class ProductClient:
    def __init__(self):
        self.channel = grpc.insecure_channel('product-service:50051')
        self.stub = product_pb2_grpc.ProductServiceStub(self.channel)

    def get_product(self, product_id: int):
        request = product_pb2.GetProductRequest(product_id=product_id)
        response = self.stub.GetProduct(request)
        return {
            'id': response.id,
            'name': response.name,
            'price': response.price,
            'category': response.category
        }
```

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

#### Message Queue (RabbitMQ, Kafka)

```python
# Publisher (Order Service)
import aio_pika

class OrderPublisher:
    def __init__(self):
        self.connection = None

    async def connect(self):
        self.connection = await aio_pika.connect_robust("amqp://guest:guest@localhost/")

    async def publish_order_created(self, order_data):
        async with self.connection.channel() as channel:
            await channel.default_exchange.publish(
                aio_pika.Message(
                    body=json.dumps(order_data).encode(),
                    message_id=str(order_data['id'])
                ),
                routing_key="order.created"
            )

# Consumer (Notification Service)
class OrderConsumer:
    def __init__(self):
        self.connection = None

    async def connect(self):
        self.connection = await aio_pika.connect_robust("amqp://guest:guest@localhost/")

    async def consume_order_created(self):
        async with self.connection.channel() as channel:
            queue = await channel.declare_queue("order.created")

            async with queue.iterator() as queue_iter:
                async for message in queue_iter:
                    async with message.process():
                        order_data = json.loads(message.body.decode())
                        await self.send_order_notification(order_data)

    async def send_order_notification(self, order_data):
        # –û—Ç–ø—Ä–∞–≤–∫–∞ email/SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        print(f"üìß –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∑–∞–∫–∞–∑–∞ {order_data['id']}")
```

#### Event Streaming (Kafka)

```python
# Producer
from aiokafka import AIOKafkaProducer
import json

class EventProducer:
    def __init__(self):
        self.producer = AIOKafkaProducer(
            bootstrap_servers='localhost:9092'
        )

    async def start(self):
        await self.producer.start()

    async def stop(self):
        await self.producer.stop()

    async def publish_event(self, topic: str, event: dict):
        await self.producer.send_and_wait(
            topic,
            json.dumps(event).encode('utf-8'),
            key=str(event['id']).encode('utf-8')
        )

# Consumer
from aiokafka import AIOKafkaConsumer

class EventConsumer:
    def __init__(self):
        self.consumer = AIOKafkaConsumer(
            'order.created',
            bootstrap_servers='localhost:9092',
            group_id='notification-service'
        )

    async def start(self):
        await self.consumer.start()

    async def consume(self):
        try:
            async for message in self.consumer:
                event = json.loads(message.value.decode('utf-8'))
                await self.handle_order_created(event)
        finally:
            await self.consumer.stop()

    async def handle_order_created(self, event):
        print(f"üìß –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è: {event}")
```

## üíæ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏

### –ü—Ä–æ–±–ª–µ–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

1. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** - –¥–∞–Ω–Ω—ã–µ –≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã
2. **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** - ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —Å–µ—Ç–µ–≤—ã–µ –≤—ã–∑–æ–≤—ã –º–µ–¥–ª–µ–Ω–Ω–µ–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
4. **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** - —Å–±–æ–∏ –≤ —Å–µ—Ç–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏

#### 1. Database per Service

```python
# –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç —Å–≤–æ—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
# Product Service -> PostgreSQL
# Order Service -> MongoDB
# User Service -> MySQL

# –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
# - –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
# - –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
# - –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

# –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
# - –°–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å–µ—Ä–≤–∏—Å–∞–º
# - Eventual consistency
# - –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
```

#### 2. Saga Pattern (–¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)

```python
# Choreography Saga
class OrderSaga:
    def __init__(self, event_publisher):
        self.publisher = event_publisher

    async def create_order(self, order_data):
        # –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑
        order = await self.order_repo.save(order_data)
        await self.publisher.publish("order.created", order)

        # –®–∞–≥ 2: –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã
        await self.publisher.publish("inventory.reserve", {
            'order_id': order.id,
            'items': order.items
        })

        # –®–∞–≥ 3: –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞—Ç–µ–∂
        await self.publisher.publish("payment.process", {
            'order_id': order.id,
            'amount': order.total
        })

# Inventory Service —Å–ª—É—à–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
class InventoryService:
    async def handle_inventory_reserve(self, event):
        try:
            # –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã
            await self.inventory_repo.reserve_items(event['items'])
            await self.publisher.publish("inventory.reserved", event)
        except Exception as e:
            # –ö–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
            await self.publisher.publish("inventory.reservation.failed", {
                **event,
                'error': str(e)
            })
```

#### 3. CQRS (Command Query Responsibility Segregation)

```python
# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏

# Write Model (Commands)
class OrderCommandService:
    async def create_order(self, command: CreateOrderCommand):
        # –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
        order = Order(command.customer_id, command.items)
        await self.order_repo.save(order)

        # –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Read Model
        await self.publisher.publish("order.created", {
            'order_id': order.id,
            'customer_id': order.customer_id,
            'items': order.items,
            'total': order.total
        })

# Read Model (Queries)
class OrderQueryService:
    async def get_customer_orders(self, customer_id: int):
        # –ß—Ç–µ–Ω–∏–µ –∏–∑ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ë–î –¥–ª—è —á—Ç–µ–Ω–∏—è
        return await self.read_repo.get_orders_by_customer(customer_id)

    async def get_order_summary(self, order_id: int):
        # –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —á—Ç–µ–Ω–∏—è
        return await self.read_repo.get_order_summary(order_id)
```

#### 4. Event Sourcing

```python
# –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞–∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏–π
import uuid

class EventStore:
    async def save_event(self, aggregate_id: str, event: dict):
        event['aggregate_id'] = aggregate_id
        event['timestamp'] = datetime.utcnow()
        event['version'] = await self.get_next_version(aggregate_id)

        await self.events_repo.save(event)

    async def get_events(self, aggregate_id: str) -> List[dict]:
        return await self.events_repo.find_by_aggregate(aggregate_id)

class OrderAggregate:
    def __init__(self, event_store: EventStore):
        self.event_store = event_store
        self.events = []

    async def create_order(self, customer_id: int, items: List[dict]):
        order_id = uuid.uuid4()
        event = {
            'type': 'order.created',
            'order_id': str(order_id),
            'customer_id': customer_id,
            'items': items,
            'total': sum(item['price'] * item['quantity'] for item in items)
        }

        await self.event_store.save_event(f"order_{order_id}", event)
        self.events.append(event)

    async def load_from_events(self, order_id: str):
        self.events = await self.event_store.get_events(order_id)

        # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ —Å–æ–±—ã—Ç–∏–π
        self.state = {}
        for event in self.events:
            self.apply_event(event)

    def apply_event(self, event: dict):
        if event['type'] == 'order.created':
            self.state.update({
                'order_id': event['order_id'],
                'customer_id': event['customer_id'],
                'items': event['items'],
                'total': event['total'],
                'status': 'created'
            })
```

## üõ°Ô∏è –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Circuit Breaker Pattern

```python
from enum import Enum
import asyncio

class CircuitState(Enum):
    CLOSED = "closed"      # –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
    OPEN = "open"         # –°–±–æ–π, –∑–∞–ø—Ä–æ—Å—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
    HALF_OPEN = "half_open" # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

class CircuitBreaker:
    def __init__(self, failure_threshold=5, timeout=60):
        self.state = CircuitState.CLOSED
        self.failure_count = 0
        self.failure_threshold = failure_threshold
        self.timeout = timeout
        self.last_failure_time = None

    async def call(self, func, *args, **kwargs):
        if self.state == CircuitState.OPEN:
            if self._should_attempt_reset():
                self.state = CircuitState.HALF_OPEN
            else:
                raise CircuitBreakerError("Circuit is open")

        try:
            result = await func(*args, **kwargs)
            self._on_success()
            return result
        except Exception as e:
            self._on_failure()
            raise e

    def _should_attempt_reset(self) -> bool:
        if self.last_failure_time is None:
            return False
        return (asyncio.get_event_loop().time() -
                self.last_failure_time) > self.timeout

    def _on_success(self):
        self.failure_count = 0
        self.state = CircuitState.CLOSED

    def _on_failure(self):
        self.failure_count += 1
        self.last_failure_time = asyncio.get_event_loop().time()

        if self.failure_count >= self.failure_threshold:
            self.state = CircuitState.OPEN
```

### Service Mesh (Istio)

```yaml
# Istio VirtualService –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: product-service
spec:
  http:
  - route:
    - destination:
        host: product-service
        subset: v1
      weight: 90
    - destination:
        host: product-service
        subset: v2
      weight: 10
---
# Istio DestinationRule –¥–ª—è –≤–µ—Ä—Å–∏–π
apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: product-service
spec:
  host: product-service
  subsets:
  - name: v1
    labels:
      version: v1
  - name: v2
    labels:
      version: v2
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ Observability

```python
# –ú–µ—Ç—Ä–∏–∫–∏ —Å Prometheus
from prometheus_client import Counter, Histogram, Gauge

# –ú–µ—Ç—Ä–∏–∫–∏ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
http_requests_total = Counter(
    'http_requests_total',
    'Total number of HTTP requests',
    ['method', 'endpoint', 'status']
)

http_request_duration = Histogram(
    'http_request_duration_seconds',
    'HTTP request duration in seconds',
    ['method', 'endpoint']
)

# –ú–µ—Ç—Ä–∏–∫–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
orders_created_total = Counter(
    'orders_created_total',
    'Total number of orders created'
)

active_connections = Gauge(
    'active_connections',
    'Number of active connections'
)

# Middleware –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫
@app.middleware("http")
async def metrics_middleware(request, call_next):
    start_time = time.time()

    response = await call_next(request)

    duration = time.time() - start_time

    http_requests_total.labels(
        method=request.method,
        endpoint=request.url.path,
        status=response.status_code
    ).inc()

    http_request_duration.labels(
        method=request.method,
        endpoint=request.url.path
    ).observe(duration)

    return response
```

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ (Distributed Tracing)

```python
# OpenTelemetry –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏
from opentelemetry import trace
from opentelemetry.sdk.trace import TracerProvider
from opentelemetry.sdk.trace.export import BatchSpanProcessor
from opentelemetry.exporter.jaeger import JaegerExporter

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏
trace.set_tracer_provider(TracerProvider())
tracer = trace.get_tracer(__name__)

jaeger_exporter = JaegerExporter(
    agent_host_name="localhost",
    agent_port=6831,
)

span_processor = BatchSpanProcessor(jaeger_exporter)
trace.get_tracer_provider().add_span_processor(span_processor)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ
@tracer.start_as_current_span("create_order")
async def create_order(order_data):
    with tracer.start_as_current_span("validate_order") as span:
        span.set_attribute("order.customer_id", order_data['customer_id'])
        # –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–∫–∞–∑–∞
        await validate_order_data(order_data)

    with tracer.start_as_current_span("save_order") as span:
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
        order = await order_repo.save(order_data)
        span.set_attribute("order.id", order.id)

    with tracer.start_as_current_span("publish_event") as span:
        # –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è
        await event_publisher.publish("order.created", order)

    return order
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### Container Orchestration (Kubernetes)

```yaml
# Deployment –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞
apiVersion: apps/v1
kind: Deployment
metadata:
  name: order-service
spec:
  replicas: 3
  selector:
    matchLabels:
      app: order-service
  template:
    metadata:
      labels:
        app: order-service
    spec:
      containers:
      - name: order-service
        image: order-service:v1.2.0
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          value: "postgresql://..."
        - name: REDIS_URL
          value: "redis://..."
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 8000
          initialDelaySeconds: 5
          periodSeconds: 5
```

### Service Discovery

```python
# Consul –¥–ª—è service discovery
import consul

class ServiceRegistry:
    def __init__(self):
        self.consul = consul.Consul()

    def register_service(self, service_name: str, service_id: str, address: str, port: int):
        self.consul.agent.service.register(
            service_name,
            service_id=service_id,
            address=address,
            port=port,
            check=consul.Check.http(f"http://{address}:{port}/health", "10s")
        )

    def discover_service(self, service_name: str):
        services = self.consul.catalog.service(service_name)[1]
        if services:
            service = services[0]
            return f"http://{service['Address']}:{service['Port']}"
        return None

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
registry = ServiceRegistry()

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞
registry.register_service("order-service", "order-1", "10.0.0.1", 8000)

# –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
order_service_url = registry.discover_service("order-service")
```

### API Gateway

```python
# API Gateway –Ω–∞ FastAPI
from fastapi import FastAPI, Request, HTTPException
import httpx

app = FastAPI(title="API Gateway")

# Service URLs (–≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏–∑ Service Discovery)
SERVICES = {
    "products": "http://product-service:8001",
    "orders": "http://order-service:8002",
    "users": "http://user-service:8003"
}

@app.api_route("/{service}/{path:path}", methods=["GET", "POST", "PUT", "DELETE"])
async def gateway(service: str, path: str, request: Request):
    if service not in SERVICES:
        raise HTTPException(status_code=404, detail="Service not found")

    service_url = f"{SERVICES[service]}/{path}"

    # –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞
    headers = dict(request.headers)
    headers.pop("host", None)  # –£–±–∏—Ä–∞–µ–º host –∑–∞–≥–æ–ª–æ–≤–æ–∫

    body = await request.body()

    async with httpx.AsyncClient() as client:
        response = await client.request(
            method=request.method,
            url=service_url,
            headers=headers,
            content=body,
            params=request.query_params
        )

        return response.json()
```

## üéÆ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 1: –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –º–æ–Ω–æ–ª–∏—Ç–∞

**–ó–∞–¥–∞–Ω–∏–µ:** –†–∞–∑–±–∏—Ç—å –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã.

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 2: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏

**–ó–∞–¥–∞–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏.

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 3: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏

**–ó–∞–¥–∞–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Saga –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã - —ç—Ç–æ –Ω–µ —Å–µ—Ä–µ–±—Ä—è–Ω–∞—è –ø—É–ª—è** - –æ–Ω–∏ –¥–æ–±–∞–≤–ª—è—é—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å
2. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è** - –∫–ª—é—á –∫ —É—Å–ø–µ—à–Ω–æ–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
3. **–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ API** - —Å–µ—Ä–≤–∏—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–≤—Ç–æ–Ω–æ–º–Ω—ã
4. **Eventual consistency** - –ø—Ä–∏–Ω—è—Ç—å –∏ –æ–±–æ–π—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ observability** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö
6. **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥** - –≤–∞–∂–Ω–µ–µ, —á–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

!!! success "–ß—Ç–æ –≤—ã —É–∑–Ω–∞–ª–∏"
    - ‚úÖ –ü—Ä–∏–Ω—Ü–∏–ø—ã –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
    - ‚úÖ –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ (HTTP, gRPC, Events)
    - ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö
    - ‚úÖ –ü–∞—Ç—Ç–µ—Ä–Ω—ã –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

!!! tip "–ü—Ä–∞–∫—Ç–∏–∫–∞"
    –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–±–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–µ –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ 2-3 –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø–æ–Ω—è—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.

–¢–µ–ø–µ—Ä—å –≤—ã –≥–æ—Ç–æ–≤—ã –∏–∑—É—á–∏—Ç—å **[–°–æ–±—ã—Ç–∏–π–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É](04-event-driven-architecture.md)** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º!

---

!!! tip "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç"
    –ù–∞—á–Ω–∏—Ç–µ —Å –º–æ–Ω–æ–ª–∏—Ç–∞ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–≤–µ—à–∏–≤–∞—é—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Domain-Driven Design –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏.

!!! info "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã"
    - [Building Microservices by Sam Newman](https://samnewman.io/books/building_microservices/)
    - [Microservices.io](https://microservices.io/)
    - [Kubernetes Documentation](https://kubernetes.io/docs/)

## üß™ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

<div class="quiz-container" id="microservices-architecture-quiz">
<script type="application/json">
{
  "title": "–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞",
  "description": "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤",
  "icon": "üèóÔ∏è",
  "questions": [
    {
      "question": "–ß—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–µ–≤–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–æ–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã?",
      "type": "single",
      "points": 1,
      "options": [
        {"text": "–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö", "correct": false},
        {"text": "–ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö", "correct": true},
        {"text": "–°–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –æ–±—â—É—é –ø–∞–º—è—Ç—å", "correct": false},
        {"text": "–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ", "correct": false}
      ],
      "explanation": "Database per Service - –æ–¥–∏–Ω –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤"
    },
    {
      "question": "–ö–∞–∫–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö?",
      "type": "single",
      "points": 1,
      "options": [
        {"text": "Factory Pattern", "correct": false},
        {"text": "Saga Pattern", "correct": true},
        {"text": "Observer Pattern", "correct": false},
        {"text": "Strategy Pattern", "correct": false}
      ],
      "explanation": "Saga Pattern –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π"
    },
    {
      "question": "–ö–∞–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–∞–µ—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞?",
      "type": "multiple",
      "points": 2,
      "options": [
        {"text": "–ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤", "correct": true},
        {"text": "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –≥–∏–±–∫–æ—Å—Ç—å", "correct": true},
        {"text": "–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏", "correct": true},
        {"text": "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö", "correct": false},
        {"text": "–£–ø—Ä–æ—â–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ", "correct": false}
      ],
      "explanation": "–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –¥–∞—é—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –≤ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –≥–∏–±–∫–æ—Å—Ç–∏, –Ω–æ –¥–æ–±–∞–≤–ª—è—é—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏"
    },
    {
      "question": "–ß—Ç–æ —Ç–∞–∫–æ–µ Circuit Breaker –ø–∞—Ç—Ç–µ—Ä–Ω?",
      "type": "single",
      "points": 1,
      "options": [
        {"text": "–ü–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ü–µ–ø–µ–π –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è", "correct": false},
        {"text": "–ü–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã—Ö —Å–±–æ–µ–≤", "correct": true},
        {"text": "–ü–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤", "correct": false},
        {"text": "–ü–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö", "correct": false}
      ],
      "explanation": "Circuit Breaker –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã–µ —Å–±–æ–∏ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö"
    },
    {
      "question": "–ö–∞–∫–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏?",
      "type": "single",
      "points": 1,
      "options": [
        {"text": "HTTP REST", "correct": true},
        {"text": "Email", "correct": false},
        {"text": "FTP", "correct": false},
        {"text": "SMS", "correct": false}
      ],
      "explanation": "HTTP REST - —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö"
    },
    {
      "question": "–ß—Ç–æ —Ç–∞–∫–æ–µ CQRS?",
      "type": "single",
      "points": 1,
      "options": [
        {"text": "Command Query Responsibility Segregation", "correct": true},
        {"text": "Create Query Read Service", "correct": false},
        {"text": "Centralized Query Resource System", "correct": false},
        {"text": "Common Query Response Standard", "correct": false}
      ],
      "explanation": "CQRS —Ä–∞–∑–¥–µ–ª—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏ –¥–ª—è –ª—É—á—à–µ–π –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏"
    },
    {
      "question": "–ö–∞–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è Service Discovery?",
      "type": "multiple",
      "points": 2,
      "options": [
        {"text": "Consul", "correct": true},
        {"text": "Zookeeper", "correct": true},
        {"text": "Kubernetes DNS", "correct": true},
        {"text": "Git", "correct": false},
        {"text": "Docker", "correct": false}
      ],
      "explanation": "Consul, Zookeeper –∏ Kubernetes DNS –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤"
    },
    {
      "question": "–ß—Ç–æ —Ç–∞–∫–æ–µ Eventual Consistency?",
      "type": "single",
      "points": 1,
      "options": [
        {"text": "–î–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã", "correct": false},
        {"text": "–î–∞–Ω–Ω—ã–µ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–º–∏ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º", "correct": true},
        {"text": "–î–∞–Ω–Ω—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã", "correct": false},
        {"text": "–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é", "correct": false}
      ],
      "explanation": "Eventual Consistency - –º–æ–¥–µ–ª—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö"
    },
    {
      "question": "–ö–∞–∫–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è container orchestration –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö?",
      "type": "single",
      "points": 1,
      "options": [
        {"text": "Kubernetes", "correct": true},
        {"text": "Apache HTTP Server", "correct": false},
        {"text": "Nginx", "correct": false},
        {"text": "PostgreSQL", "correct": false}
      ],
      "explanation": "Kubernetes - —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö"
    },
    {
      "question": "–ß—Ç–æ —Ç–∞–∫–æ–µ API Gateway –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ?",
      "type": "single",
      "points": 1,
      "options": [
        {"text": "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è API", "correct": false},
        {"text": "–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤", "correct": true},
        {"text": "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API", "correct": false},
        {"text": "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏", "correct": false}
      ],
      "explanation": "API Gateway - –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º"
    }
  ]
}
</script>
</div>

## üíª –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

{{ create_exercise_form(
    "microservices_design",
    "–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¥–ª—è e-commerce –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã",
    "–°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π—Ç–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è e-commerce –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–µ–π, –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–µ–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã–º–∏.",
    """# –ó–∞–¥–∞–Ω–∏–µ: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ E-commerce

–†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è –∫—Ä—É–ø–Ω–æ–π e-commerce –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏:

## –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- **–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤** - 10M+ —Ç–æ–≤–∞—Ä–æ–≤, —Å–ª–æ–∂–Ω—ã–π –ø–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏** - 100K+ –∑–∞–∫–∞–∑–æ–≤ –≤ –¥–µ–Ω—å
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 10+ –ø–ª–∞—Ç–µ–∂–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏** - 1M+ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** - –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** - –æ—Ç—á–µ—Ç—ã –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - email, SMS, push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **–õ–æ–≥–∏—Å—Ç–∏–∫–∞** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–ª—É–∂–±–∞–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- **–ù–∞–≥—Ä—É–∑–∫–∞**: 10,000+ RPS –≤ –ø–∏–∫–æ–≤—ã–µ —á–∞—Å—ã
- **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**: 99.99% SLA
- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞**: < 100ms –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –†–æ—Å—Ç –Ω–∞ 500% –≤ –±–ª–∏–∂–∞–π—à–∏–µ 2 –≥–æ–¥–∞
- **–ö–æ–º–∞–Ω–¥—ã**: 15+ –∫–æ–º–∞–Ω–¥ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**: Python, Go, Node.js (–ø–æ –≤—ã–±–æ—Ä—É –∫–æ–º–∞–Ω–¥)

## –ó–∞–¥–∞—á–∏ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏

### 1. Domain Analysis (–ê–Ω–∞–ª–∏–∑ –¥–æ–º–µ–Ω–∞)

–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ bounded contexts –∏ —Å–µ—Ä–≤–∏—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∏–∑–Ω–µ—Å-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π:

```
üè™ E-commerce Domain
‚îú‚îÄ‚îÄ üì¶ Product Domain
‚îÇ   ‚îú‚îÄ‚îÄ Product Catalog Service
‚îÇ   ‚îú‚îÄ‚îÄ Product Search Service
‚îÇ   ‚îú‚îÄ‚îÄ Product Recommendation Service
‚îÇ   ‚îî‚îÄ‚îÄ Product Review Service
‚îú‚îÄ‚îÄ üë§ Customer Domain
‚îÇ   ‚îú‚îÄ‚îÄ Customer Profile Service
‚îÇ   ‚îú‚îÄ‚îÄ Customer Authentication Service
‚îÇ   ‚îú‚îÄ‚îÄ Customer Preferences Service
‚îÇ   ‚îî‚îÄ‚îÄ Customer History Service
‚îú‚îÄ‚îÄ üõí Order Domain
‚îÇ   ‚îú‚îÄ‚îÄ Order Management Service
‚îÇ   ‚îú‚îÄ‚îÄ Order Processing Service
‚îÇ   ‚îú‚îÄ‚îÄ Order Tracking Service
‚îÇ   ‚îî‚îÄ‚îÄ Order Analytics Service
‚îú‚îÄ‚îÄ üí≥ Payment Domain
‚îÇ   ‚îú‚îÄ‚îÄ Payment Processing Service
‚îÇ   ‚îú‚îÄ‚îÄ Payment Gateway Integration
‚îÇ   ‚îú‚îÄ‚îÄ Fraud Detection Service
‚îÇ   ‚îî‚îÄ‚îÄ Refund Management Service
‚îú‚îÄ‚îÄ üì¨ Notification Domain
‚îÇ   ‚îú‚îÄ‚îÄ Email Service
‚îÇ   ‚îú‚îÄ‚îÄ SMS Service
‚îÇ   ‚îú‚îÄ‚îÄ Push Notification Service
‚îÇ   ‚îî‚îÄ‚îÄ Notification Template Service
‚îî‚îÄ‚îÄ üöö Logistics Domain
    ‚îú‚îÄ‚îÄ Shipping Service
    ‚îú‚îÄ‚îÄ Warehouse Management Service
    ‚îú‚îÄ‚îÄ Delivery Tracking Service
    ‚îî‚îÄ‚îÄ Returns Management Service
```

### 2. Service Design (–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤)

#### Product Service (Python + FastAPI)
```python
# product_service/src/main.py
from fastapi import FastAPI
from pydantic import BaseModel
from typing import List, Optional

app = FastAPI(title="Product Service", version="1.0.0")

class Product(BaseModel):
    id: str
    name: str
    description: str
    price: float
    category: str
    images: List[str]
    attributes: dict

class ProductService:
    def __init__(self, product_repo, search_service, cache):
        self.product_repo = product_repo
        self.search_service = search_service
        self.cache = cache

    async def get_product(self, product_id: str) -> Optional[Product]:
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –∫—ç—à–∞
        cached = await self.cache.get(f"product:{product_id}")
        if cached:
            return Product(**cached)

        # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –ë–î
        product = await self.product_repo.get_by_id(product_id)
        if product:
            await self.cache.set(f"product:{product_id}", product.dict(), ttl=3600)

        return product

    async def search_products(self, query: str, filters: dict) -> List[Product]:
        # –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –≤ Search Service
        search_results = await self.search_service.search(query, filters)

        # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
        products = []
        for result in search_results:
            product = await self.get_product(result['id'])
            if product:
                products.append(product)

        return products

# API Endpoints
@app.get("/products/{product_id}")
async def get_product(product_id: str):
    # TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç
    pass

@app.get("/products/search")
async def search_products(q: str, category: Optional[str] = None):
    # TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫
    pass
```

#### Order Service (Go)
```go
// order_service/main.go
package main

import (
    "context"
    "encoding/json"
    "net/http"
    "github.com/gorilla/mux"
)

type Order struct {
    ID         string  `json:"id"`
    CustomerID string  `json:"customer_id"`
    Items      []OrderItem `json:"items"`
    Status     string  `json:"status"`
    Total      float64 `json:"total"`
}

type OrderService struct {
    repo     OrderRepository
    producer EventProducer
}

func (s *OrderService) CreateOrder(ctx context.Context, customerID string, items []OrderItem) (*Order, error) {
    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ Product Service
    if err := s.validateItems(ctx, items); err != nil {
        return nil, err
    }

    // –†–∞—Å—á–µ—Ç –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏
    total := s.calculateTotal(items)

    // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
    order := &Order{
        ID:         generateID(),
        CustomerID: customerID,
        Items:      items,
        Status:     "pending",
        Total:      total,
    }

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
    if err := s.repo.Save(order); err != nil {
        return nil, err
    }

    // –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è
    event := OrderCreatedEvent{
        OrderID:    order.ID,
        CustomerID: customerID,
        Total:      total,
    }

    if err := s.producer.Publish("order.created", event); err != nil {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
        log.Printf("Failed to publish event: %v", err)
    }

    return order, nil
}

func main() {
    service := &OrderService{
        repo:     NewPostgresOrderRepository(),
        producer: NewKafkaProducer(),
    }

    r := mux.NewRouter()
    r.HandleFunc("/orders", service.CreateOrderHandler).Methods("POST")
    r.HandleFunc("/orders/{id}", service.GetOrderHandler).Methods("GET")

    http.ListenAndServe(":8080", r)
}
```

#### Payment Service (Node.js)
```javascript
// payment_service/app.js
const express = require('express');
const { Kafka } = require('kafkajs');

class PaymentService {
    constructor() {
        this.kafka = new Kafka({
            clientId: 'payment-service',
            brokers: ['kafka:9092']
        });
        this.consumer = this.kafka.consumer({ groupId: 'payment-group' });
    }

    async processPayment(orderEvent) {
        console.log(`Processing payment for order ${orderEvent.orderId}`);

        try {
            // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π
            const paymentResult = await this.paymentGateway.charge({
                amount: orderEvent.total,
                currency: 'USD',
                orderId: orderEvent.orderId
            });

            if (paymentResult.success) {
                // –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã
                await this.producer.send({
                    topic: 'payment.succeeded',
                    messages: [{
                        value: JSON.stringify({
                            orderId: orderEvent.orderId,
                            paymentId: paymentResult.paymentId,
                            amount: orderEvent.total
                        })
                    }]
                });
            } else {
                // –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è –Ω–µ—É–¥–∞—á–Ω–æ–π –æ–ø–ª–∞—Ç—ã
                await this.producer.send({
                    topic: 'payment.failed',
                    messages: [{
                        value: JSON.stringify({
                            orderId: orderEvent.orderId,
                            reason: paymentResult.error
                        })
                    }]
                });
            }
        } catch (error) {
            console.error(`Payment failed: ${error.message}`);
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
        }
    }

    async start() {
        await this.consumer.connect();
        await this.consumer.subscribe({ topic: 'order.created' });

        await this.consumer.run({
            eachMessage: async ({ topic, partition, message }) => {
                const orderEvent = JSON.parse(message.value.toString());
                await this.processPayment(orderEvent);
            }
        });
    }
}

const app = express();
const paymentService = new PaymentService();

// Health check endpoint
app.get('/health', (req, res) => {
    res.json({ status: 'ok' });
});

app.listen(3000, () => {
    console.log('Payment Service listening on port 3000');
    paymentService.start();
});
```

### 3. Communication Patterns (–ü–∞—Ç—Ç–µ—Ä–Ω—ã –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏)

#### Synchronous Communication (REST/gRPC)
```python
# API Gateway –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
class APIGateway:
    def __init__(self):
        self.service_registry = ServiceRegistry()

    async def route_request(self, service: str, path: str, method: str, data: dict):
        # –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —Å–µ—Ä–≤–∏—Å–∞
        service_url = await self.service_registry.discover(service)

        # Circuit Breaker –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–±–æ–µ–≤
        circuit_breaker = CircuitBreaker()

        # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Å retry
        return await circuit_breaker.call(
            self._make_request,
            service_url,
            path,
            method,
            data
        )

    async def _make_request(self, service_url, path, method, data):
        async with aiohttp.ClientSession() as session:
            url = f"{service_url}/{path}"
            async with session.request(method, url, json=data) as response:
                return await response.json()
```

#### Asynchronous Communication (Events)
```python
# Event Bus –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
class EventBus:
    def __init__(self):
        self.handlers = defaultdict(list)

    def subscribe(self, event_type: str, handler: Callable):
        self.handlers[event_type].append(handler)

    async def publish(self, event_type: str, event_data: dict):
        # –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è –≤—Å–µ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º
        tasks = []
        for handler in self.handlers[event_type]:
            task = asyncio.create_task(handler(event_data))
            tasks.append(task)

        # –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
        await asyncio.gather(*tasks, return_exceptions=True)

# Saga Pattern –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
class OrderSaga:
    def __init__(self, event_bus: EventBus):
        self.event_bus = event_bus
        self.steps = []
        self.compensations = []

    async def execute(self, order_data: dict):
        try:
            # –®–∞–≥ 1: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
            await self.create_order(order_data)
            self.compensations.append(self.cancel_order)

            # –®–∞–≥ 2: –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
            await self.reserve_inventory(order_data)
            self.compensations.append(self.release_inventory)

            # –®–∞–≥ 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞
            await self.process_payment(order_data)
            self.compensations.append(self.refund_payment)

            # –®–∞–≥ 4: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
            await self.confirm_order(order_data)

        except Exception as e:
            # –ö–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ
            await self.rollback()

    async def rollback(self):
        for compensation in reversed(self.compensations):
            try:
                await compensation()
            except Exception as e:
                logger.error(f"Compensation failed: {e}")
```

### 4. Data Management (–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏)

#### CQRS Implementation
```python
# Write Model (Commands)
class OrderCommandService:
    def __init__(self, event_store: EventStore):
        self.event_store = event_store

    async def create_order(self, command: CreateOrderCommand):
        # –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª
        await self.validate_business_rules(command)

        # –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
        event = OrderCreatedEvent(
            order_id=uuid.uuid4(),
            customer_id=command.customer_id,
            items=command.items,
            total=command.total
        )

        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
        await self.event_store.save_event(event)

        # –ü—É–±–ª–∏–∫–∞—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Read Model
        await self.event_publisher.publish("order.created", event)

# Read Model (Queries)
class OrderQueryService:
    def __init__(self, read_repository: OrderReadRepository):
        self.read_repo = read_repository

    async def get_customer_orders(self, customer_id: str) -> List[OrderSummary]:
        # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è —á—Ç–µ–Ω–∏—è
        return await self.read_repo.get_orders_by_customer(customer_id)

    async def get_order_details(self, order_id: str) -> OrderDetails:
        # –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–µ
        return await self.read_repo.get_order_details(order_id)

# Event Handler –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Read Model
class OrderReadModelHandler:
    def __init__(self, read_repository: OrderReadRepository):
        self.read_repo = read_repository

    async def handle_order_created(self, event: OrderCreatedEvent):
        # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ Read Model
        order_summary = OrderSummary(
            id=event.order_id,
            customer_id=event.customer_id,
            status="created",
            total=event.total,
            created_at=datetime.utcnow()
        )

        await self.read_repo.save_order_summary(order_summary)

        # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Ç–æ–≤–∞—Ä–æ–≤
        for item in event.items:
            order_item = OrderItem(
                order_id=event.order_id,
                product_id=item.product_id,
                quantity=item.quantity,
                price=item.price
            )
            await self.read_repo.save_order_item(order_item)
```

### 5. Infrastructure and Deployment

#### Kubernetes Manifests
```yaml
# order-service-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: order-service
spec:
  replicas: 3
  selector:
    matchLabels:
      app: order-service
  template:
    metadata:
      labels:
        app: order-service
    spec:
      containers:
      - name: order-service
        image: order-service:v1.0.0
        ports:
        - containerPort: 8080
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: order-db-url
        - name: KAFKA_BROKERS
          value: "kafka-cluster:9092"
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8080
          initialDelaySeconds: 30
        readinessProbe:
          httpGet:
            path: /ready
            port: 8080
---
# order-service-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: order-service
spec:
  selector:
    app: order-service
  ports:
    - port: 80
      targetPort: 8080
  type: ClusterIP
```

#### Service Mesh Configuration
```yaml
# Istio Virtual Service
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: order-service
spec:
  http:
  - match:
    - uri:
        prefix: "/api/orders"
    route:
    - destination:
        host: order-service
    timeout: 30s
    retries:
      attempts: 3
      perTryTimeout: 10s
---
# Istio Destination Rule
apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: order-service
spec:
  host: order-service
  trafficPolicy:
    loadBalancer:
      simple: ROUND_ROBIN
    connectionPool:
      tcp:
        maxConnections: 100
      http:
        http1MaxPendingRequests: 10
        maxRequestsPerConnection: 10
```

### 6. Monitoring and Observability

#### Metrics Collection
```python
# Prometheus metrics –¥–ª—è Order Service
from prometheus_client import Counter, Histogram, Gauge

# Business metrics
orders_created_total = Counter(
    'orders_created_total',
    'Total number of orders created'
)

order_creation_duration = Histogram(
    'order_creation_duration_seconds',
    'Time spent creating orders',
    buckets=[0.1, 0.5, 1.0, 2.0, 5.0]
)

active_orders = Gauge(
    'active_orders',
    'Number of currently active orders'
)

# Technical metrics
http_requests_total = Counter(
    'http_requests_total',
    'Total HTTP requests',
    ['method', 'endpoint', 'status']
)

database_connection_pool_size = Gauge(
    'database_connection_pool_size',
    'Current database connection pool size'
)
```

#### Distributed Tracing
```python
# OpenTelemetry tracing
from opentelemetry import trace
from opentelemetry.sdk.trace import TracerProvider
from opentelemetry.sdk.trace.export import BatchSpanProcessor
from opentelemetry.exporter.jaeger import JaegerExporter

trace.set_tracer_provider(TracerProvider())
tracer = trace.get_tracer("order-service")

jaeger_exporter = JaegerExporter(
    agent_host_name="jaeger-agent",
    agent_port=6831,
)

trace.get_tracer_provider().add_span_processor(
    BatchSpanProcessor(jaeger_exporter)
)

class OrderService:
    @tracer.start_as_current_span("create_order")
    async def create_order(self, customer_id: str, items: List[dict]):
        with tracer.start_as_current_span("validate_customer") as span:
            span.set_attribute("customer.id", customer_id)
            await self.validate_customer(customer_id)

        with tracer.start_as_current_span("validate_items") as span:
            span.set_attribute("items.count", len(items))
            await self.validate_items(items)

        with tracer.start_as_current_span("calculate_total") as span:
            total = self.calculate_total(items)
            span.set_attribute("order.total", total)

        with tracer.start_as_current_span("save_order") as span:
            order = await self.save_order(customer_id, items, total)
            span.set_attribute("order.id", order.id)

        return order
```

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–°–æ–∑–¥–∞–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å:

1. **Domain Decomposition** - –¥–∏–∞–≥—Ä–∞–º–º–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –∏—Ö –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
2. **Service Contracts** - API —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
3. **Communication Patterns** - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è
4. **Data Management** - —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏
5. **Infrastructure Design** - Kubernetes manifests, monitoring
6. **Deployment Strategy** - CI/CD, blue-green deployment
7. **Risk Assessment** - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

## –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

### Event Sourcing + CQRS
```python
# –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Event Sourcing
class EventSourcedAggregate:
    def __init__(self, aggregate_id: str):
        self.aggregate_id = aggregate_id
        self.version = 0
        self.uncommitted_events = []

    def apply_event(self, event: DomainEvent):
        self._apply(event, is_new=False)

    def _apply(self, event: DomainEvent, is_new: bool = True):
        # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –∫ –∞–≥—Ä–µ–≥–∞—Ç—É
        method_name = f"apply_{event.__class__.__name__.lower()}"
        method = getattr(self, method_name, None)
        if method:
            method(event)

        self.version += 1

        if is_new:
            self.uncommitted_events.append(event)

    def mark_events_as_committed(self):
        self.uncommitted_events.clear()

# CQRS Command Handler
class OrderCommandHandler:
    def __init__(self, event_store: EventStore, event_publisher: EventPublisher):
        self.event_store = event_store
        self.event_publisher = event_publisher

    async def handle_create_order(self, command: CreateOrderCommand):
        # –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∞–≥—Ä–µ–≥–∞—Ç–∞ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ
        aggregate = await self.load_aggregate(command.order_id)

        # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
        aggregate.create_order(command.customer_id, command.items)

        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
        await self.event_store.save_events(
            aggregate.aggregate_id,
            aggregate.uncommitted_events
        )

        # –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
        for event in aggregate.uncommitted_events:
            await self.event_publisher.publish(event)

        aggregate.mark_events_as_committed()

    async def load_aggregate(self, aggregate_id: str) -> OrderAggregate:
        events = await self.event_store.get_events(aggregate_id)
        aggregate = OrderAggregate(aggregate_id)

        for event in events:
            aggregate.apply_event(event)

        return aggregate
```

### Service Mesh Patterns
```yaml
# Istio Traffic Management
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: order-service-routing
spec:
  http:
  - match:
    - headers:
        x-customer-tier:
          exact: "gold"
    route:
    - destination:
        host: order-service
        subset: gold
  - route:
    - destination:
        host: order-service
        subset: standard

---
apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: order-service-subsets
spec:
  host: order-service
  subsets:
  - name: gold
    labels:
      version: gold
  - name: standard
    labels:
      version: standard
```

---

*–ü–æ–º–Ω–∏—Ç–µ: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–µ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ "—ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ". –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å–≤–æ–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç!*""",
    [
        "–ü—Ä–æ–≤–µ—Å—Ç–∏ domain analysis –∏ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—é –Ω–∞ bounded contexts",
        "–°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å API –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤",
        "–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è)",
        "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å CQRS + Event Sourcing –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏",
        "–°–æ–∑–¥–∞—Ç—å Kubernetes manifests –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è",
        "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ distributed tracing",
        "–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ —Ä–∏—Å–∫–∏"
    ]
) }}














