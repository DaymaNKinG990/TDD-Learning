# TDD –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üéØ –í–≤–µ–¥–µ–Ω–∏–µ

Test-Driven Development –≤–ª–∏—è–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞, –Ω–æ –∏ –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. TDD –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≤–µ–¥–µ—Ç –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Å–ª–∞–±–æ —Å–≤—è–∑–∞–Ω–Ω–æ–π, –≤—ã—Å–æ–∫–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä–∞—è —Å–ª–µ–¥—É–µ—Ç –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –í —ç—Ç–æ–π –≥–ª–∞–≤–µ –º—ã –∏–∑—É—á–∏–º, –∫–∞–∫ TDD —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ –∫–∞–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ª—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º.

## üèóÔ∏è –í–ª–∏—è–Ω–∏–µ TDD –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

TDD —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä–∞—è:

1. **–°–ª–∞–±–æ —Å–≤—è–∑–∞–Ω–∞** ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ –∑–∞–≤–∏—Å—è—Ç –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –Ω–∞–ø—Ä—è–º—É—é
2. **–í—ã—Å–æ–∫–æ —Å–≤—è–∑–Ω–∞** ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ –æ–¥–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
3. **–õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–∞** ‚Äî –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ
4. **–ì–∏–±–∫–∞ –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º** ‚Äî –Ω–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—Ç—Å—è

### –ü—Ä–∏–º–µ—Ä: —ç–≤–æ–ª—é—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —á–µ—Ä–µ–∑ TDD

```python
# –ù–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è - –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥
class OrderService:
    def process_order(self, order_data):
        # –í–∞–ª–∏–¥–∞—Ü–∏—è
        if not order_data.get('customer_id'):
            return False
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ inventory
        db = MySQLDatabase()
        inventory = db.get_inventory(order_data['product_id'])
        if inventory < order_data['quantity']:
            return False
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞
        payment_gateway = PayPalGateway()
        payment_result = payment_gateway.charge(order_data['amount'])
        if not payment_result.success:
            return False
        
        # –û—Ç–ø—Ä–∞–≤–∫–∞ email
        smtp = SMTPService()
        smtp.send_email(order_data['customer_email'], "Order confirmation")
        
        return True

# –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è TDD - —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
class OrderService:
    def __init__(self, 
                 validator: OrderValidator,
                 inventory_checker: InventoryChecker,
                 payment_processor: PaymentProcessor,
                 notification_service: NotificationService):
        self.validator = validator
        self.inventory_checker = inventory_checker
        self.payment_processor = payment_processor
        self.notification_service = notification_service
    
    def process_order(self, order_data: OrderData) -> OrderResult:
        # –ö–∞–∂–¥—ã–π —à–∞–≥ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
        validation_result = self.validator.validate(order_data)
        if not validation_result.is_valid:
            return OrderResult.failure(validation_result.errors)
        
        if not self.inventory_checker.is_available(order_data.product_id, order_data.quantity):
            return OrderResult.failure(["Product not available"])
        
        payment_result = self.payment_processor.process(order_data.payment_info)
        if not payment_result.is_successful:
            return OrderResult.failure(["Payment failed"])
        
        self.notification_service.send_confirmation(order_data.customer_email)
        
        return OrderResult.success(payment_result.transaction_id)
```

## üé≠ SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã –≤ TDD

### Single Responsibility Principle (SRP)

TDD –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤–µ–¥–µ—Ç –∫ SRP, —Ç–∞–∫ –∫–∞–∫ –ª–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å—ã —Å –æ–¥–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é.

```python
# –ù–∞—Ä—É—à–µ–Ω–∏–µ SRP - —Å–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
class UserManager:
    def create_user(self, user_data):
        # –í–∞–ª–∏–¥–∞—Ü–∏—è
        if not self._validate_email(user_data['email']):
            raise ValueError("Invalid email")
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
        self._save_to_database(user_data)
        
        # –û—Ç–ø—Ä–∞–≤–∫–∞ email
        self._send_welcome_email(user_data['email'])
        
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        self._log_user_creation(user_data)

# –°–ª–µ–¥–æ–≤–∞–Ω–∏–µ SRP - –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
class EmailValidator:
    def validate(self, email: str) -> bool:
        return "@" in email and "." in email.split("@")[1]

class UserRepository:
    def save(self, user: User) -> User:
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
        pass

class WelcomeEmailService:
    def send_welcome_email(self, email: str) -> None:
        # –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ email
        pass

class UserCreationLogger:
    def log_creation(self, user: User) -> None:
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        pass

class UserService:
    def __init__(self, 
                 validator: EmailValidator,
                 repository: UserRepository,
                 email_service: WelcomeEmailService,
                 logger: UserCreationLogger):
        self.validator = validator
        self.repository = repository
        self.email_service = email_service
        self.logger = logger
    
    def create_user(self, user_data: dict) -> User:
        if not self.validator.validate(user_data['email']):
            raise ValueError("Invalid email")
        
        user = User.from_dict(user_data)
        saved_user = self.repository.save(user)
        
        self.email_service.send_welcome_email(saved_user.email)
        self.logger.log_creation(saved_user)
        
        return saved_user

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º
def test_user_service_create_user():
    # –ú–æ–∫–∏—Ä—É–µ–º –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    mock_validator = Mock()
    mock_validator.validate.return_value = True
    
    mock_repository = Mock()
    mock_repository.save.return_value = User(id=1, email="test@example.com")
    
    mock_email_service = Mock()
    mock_logger = Mock()
    
    service = UserService(mock_validator, mock_repository, mock_email_service, mock_logger)
    
    user_data = {"email": "test@example.com", "name": "Test User"}
    result = service.create_user(user_data)
    
    assert result.email == "test@example.com"
    mock_validator.validate.assert_called_once_with("test@example.com")
    mock_repository.save.assert_called_once()
    mock_email_service.send_welcome_email.assert_called_once()
    mock_logger.log_creation.assert_called_once()
```

### Open/Closed Principle (OCP)

TDD —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏.

```python
from abc import ABC, abstractmethod

# –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
class NotificationSender(ABC):
    @abstractmethod
    def send(self, recipient: str, message: str) -> bool:
        pass

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
class EmailNotificationSender(NotificationSender):
    def send(self, recipient: str, message: str) -> bool:
        # –û—Ç–ø—Ä–∞–≤–∫–∞ email
        return True

class SMSNotificationSender(NotificationSender):
    def send(self, recipient: str, message: str) -> bool:
        # –û—Ç–ø—Ä–∞–≤–∫–∞ SMS
        return True

class PushNotificationSender(NotificationSender):
    def send(self, recipient: str, message: str) -> bool:
        # –û—Ç–ø—Ä–∞–≤–∫–∞ push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        return True

# –°–µ—Ä–≤–∏—Å, –∑–∞–∫—Ä—ã—Ç—ã–π –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏, –Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
class NotificationService:
    def __init__(self, senders: list[NotificationSender]):
        self.senders = senders
    
    def send_notification(self, recipient: str, message: str) -> list[bool]:
        results = []
        for sender in self.senders:
            try:
                result = sender.send(recipient, message)
                results.append(result)
            except Exception:
                results.append(False)
        return results

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
class SlackNotificationSender(NotificationSender):
    def send(self, recipient: str, message: str) -> bool:
        # –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Slack
        return True

def test_notification_service_with_multiple_senders():
    email_sender = Mock()
    email_sender.send.return_value = True
    
    sms_sender = Mock()
    sms_sender.send.return_value = True
    
    slack_sender = Mock()
    slack_sender.send.return_value = True
    
    service = NotificationService([email_sender, sms_sender, slack_sender])
    results = service.send_notification("user@example.com", "Hello")
    
    assert results == [True, True, True]
    assert email_sender.send.call_count == 1
    assert sms_sender.send.call_count == 1
    assert slack_sender.send.call_count == 1
```

### Dependency Inversion Principle (DIP)

TDD —Ç—Ä–µ–±—É–µ—Ç –∏–Ω–≤–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏.

```python
# –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –º–æ–¥—É–ª–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö
# –ù–∞—Ä—É—à–µ–Ω–∏–µ DIP
class OrderProcessor:
    def __init__(self):
        self.mysql_db = MySQLDatabase()  # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
        self.paypal = PayPalGateway()    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
    
    def process(self, order):
        # –°–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑-–∑–∞ –∂–µ—Å—Ç–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        pass

# –°–ª–µ–¥–æ–≤–∞–Ω–∏–µ DIP
class OrderRepository(ABC):
    @abstractmethod
    def save_order(self, order: Order) -> int:
        pass

class PaymentGateway(ABC):
    @abstractmethod
    def process_payment(self, amount: float, payment_info: dict) -> PaymentResult:
        pass

class OrderProcessor:
    def __init__(self, 
                 order_repository: OrderRepository,
                 payment_gateway: PaymentGateway):
        self.order_repository = order_repository
        self.payment_gateway = payment_gateway
    
    def process(self, order: Order) -> ProcessingResult:
        payment_result = self.payment_gateway.process_payment(
            order.total_amount, 
            order.payment_info
        )
        
        if payment_result.is_successful:
            order_id = self.order_repository.save_order(order)
            return ProcessingResult.success(order_id)
        
        return ProcessingResult.failure(payment_result.error_message)

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
class MySQLOrderRepository(OrderRepository):
    def save_order(self, order: Order) -> int:
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ MySQL
        pass

class PayPalGateway(PaymentGateway):
    def process_payment(self, amount: float, payment_info: dict) -> PaymentResult:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ PayPal
        pass

# –õ–µ–≥–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–ª–∞–≥–æ–¥–∞—Ä—è DIP
def test_order_processor():
    mock_repository = Mock()
    mock_repository.save_order.return_value = 123
    
    mock_gateway = Mock()
    mock_gateway.process_payment.return_value = PaymentResult.success("txn_456")
    
    processor = OrderProcessor(mock_repository, mock_gateway)
    order = Order(total_amount=100.0, payment_info={"card": "1234"})
    
    result = processor.process(order)
    
    assert result.is_successful
    assert result.order_id == 123
```

## üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è TDD

### 1. Hexagonal Architecture (Ports & Adapters)

```python
# Domain Layer - —Ü–µ–Ω—Ç—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
class User:
    def __init__(self, email: str, name: str):
        self.email = email
        self.name = name
        self.is_active = True
    
    def deactivate(self):
        self.is_active = False
    
    def change_email(self, new_email: str):
        if "@" not in new_email:
            raise ValueError("Invalid email format")
        self.email = new_email

# Ports - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
class UserRepository(ABC):
    @abstractmethod
    def save(self, user: User) -> User:
        pass
    
    @abstractmethod
    def find_by_email(self, email: str) -> Optional[User]:
        pass

class EmailService(ABC):
    @abstractmethod
    def send_confirmation(self, email: str, token: str) -> bool:
        pass

# Application Layer - use cases
class UserRegistrationUseCase:
    def __init__(self, 
                 user_repository: UserRepository,
                 email_service: EmailService):
        self.user_repository = user_repository
        self.email_service = email_service
    
    def register_user(self, email: str, name: str) -> User:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        existing_user = self.user_repository.find_by_email(email)
        if existing_user:
            raise ValueError("User already exists")
        
        # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user = User(email, name)
        saved_user = self.user_repository.save(user)
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        confirmation_token = "abc123"  # –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
        self.email_service.send_confirmation(email, confirmation_token)
        
        return saved_user

# Adapters - –≤–Ω–µ—à–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
class SQLAlchemyUserRepository(UserRepository):
    def __init__(self, session):
        self.session = session
    
    def save(self, user: User) -> User:
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ SQLAlchemy
        pass
    
    def find_by_email(self, email: str) -> Optional[User]:
        # –ü–æ–∏—Å–∫ —á–µ—Ä–µ–∑ SQLAlchemy
        pass

class SMTPEmailService(EmailService):
    def send_confirmation(self, email: str, token: str) -> bool:
        # –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ SMTP
        pass

# Web Adapter (FastAPI)
from fastapi import FastAPI, Depends

app = FastAPI()

def get_user_registration_use_case() -> UserRegistrationUseCase:
    # Dependency injection
    session = get_db_session()
    user_repository = SQLAlchemyUserRepository(session)
    email_service = SMTPEmailService()
    return UserRegistrationUseCase(user_repository, email_service)

@app.post("/users/register")
async def register_user(
    user_data: UserRegistrationRequest,
    use_case: UserRegistrationUseCase = Depends(get_user_registration_use_case)
):
    try:
        user = use_case.register_user(user_data.email, user_data.name)
        return {"success": True, "user_id": user.id}
    except ValueError as e:
        return {"success": False, "error": str(e)}

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ use case –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ
def test_user_registration_use_case():
    mock_repository = Mock()
    mock_repository.find_by_email.return_value = None
    mock_repository.save.return_value = User("test@example.com", "Test User")
    
    mock_email_service = Mock()
    mock_email_service.send_confirmation.return_value = True
    
    use_case = UserRegistrationUseCase(mock_repository, mock_email_service)
    
    user = use_case.register_user("test@example.com", "Test User")
    
    assert user.email == "test@example.com"
    assert user.name == "Test User"
    mock_repository.save.assert_called_once()
    mock_email_service.send_confirmation.assert_called_once()
```

### 2. Clean Architecture

```python
# Entities - —Ü–µ–Ω—Ç—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
class Order:
    def __init__(self, customer_id: int, items: list):
        self.customer_id = customer_id
        self.items = items
        self.status = "pending"
        self.total = self._calculate_total()
    
    def _calculate_total(self) -> float:
        return sum(item.price * item.quantity for item in self.items)
    
    def confirm(self):
        if not self.items:
            raise ValueError("Cannot confirm empty order")
        self.status = "confirmed"
    
    def cancel(self):
        if self.status == "shipped":
            raise ValueError("Cannot cancel shipped order")
        self.status = "cancelled"

# Use Cases
class ConfirmOrderUseCase:
    def __init__(self, 
                 order_repository: OrderRepository,
                 inventory_service: InventoryService,
                 notification_service: NotificationService):
        self.order_repository = order_repository
        self.inventory_service = inventory_service
        self.notification_service = notification_service
    
    def execute(self, order_id: int) -> ConfirmOrderResult:
        order = self.order_repository.find_by_id(order_id)
        if not order:
            return ConfirmOrderResult.failure("Order not found")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
        for item in order.items:
            if not self.inventory_service.is_available(item.product_id, item.quantity):
                return ConfirmOrderResult.failure(f"Product {item.product_id} not available")
        
        # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –∑–∞–∫–∞–∑
        order.confirm()
        self.order_repository.save(order)
        
        # –£–≤–µ–¥–æ–º–ª—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞
        self.notification_service.send_order_confirmation(order.customer_id, order.id)
        
        return ConfirmOrderResult.success(order.id)

# Interface Adapters
class OrderController:
    def __init__(self, confirm_order_use_case: ConfirmOrderUseCase):
        self.confirm_order_use_case = confirm_order_use_case
    
    def confirm_order(self, order_id: int) -> dict:
        result = self.confirm_order_use_case.execute(order_id)
        
        if result.is_successful:
            return {
                "status": "success",
                "order_id": result.order_id,
                "message": "Order confirmed successfully"
            }
        else:
            return {
                "status": "error",
                "message": result.error_message
            }

# Frameworks & Drivers
class FlaskOrderController(OrderController):
    def setup_routes(self, app):
        @app.route('/orders/<int:order_id>/confirm', methods=['POST'])
        def confirm_order_endpoint(order_id):
            return self.confirm_order(order_id)

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Å–ª–æ—è–º
def test_order_entity():
    """–¢–µ—Å—Ç entity –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ."""
    items = [Item(product_id=1, quantity=2, price=10.0)]
    order = Order(customer_id=123, items=items)
    
    assert order.total == 20.0
    assert order.status == "pending"
    
    order.confirm()
    assert order.status == "confirmed"

def test_confirm_order_use_case():
    """–¢–µ—Å—Ç use case —Å –º–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏."""
    mock_repository = Mock()
    mock_inventory = Mock()
    mock_notification = Mock()
    
    # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –º–æ–∫–∏
    order = Order(customer_id=123, items=[Item(product_id=1, quantity=1, price=10.0)])
    mock_repository.find_by_id.return_value = order
    mock_inventory.is_available.return_value = True
    
    use_case = ConfirmOrderUseCase(mock_repository, mock_inventory, mock_notification)
    result = use_case.execute(1)
    
    assert result.is_successful
    assert order.status == "confirmed"
    mock_repository.save.assert_called_once_with(order)
    mock_notification.send_order_confirmation.assert_called_once()

def test_order_controller():
    """–¢–µ—Å—Ç controller —Å –º–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º use case."""
    mock_use_case = Mock()
    mock_use_case.execute.return_value = ConfirmOrderResult.success(1)
    
    controller = OrderController(mock_use_case)
    response = controller.confirm_order(1)
    
    assert response["status"] == "success"
    assert response["order_id"] == 1
    mock_use_case.execute.assert_called_once_with(1)
```

### 3. CQRS (Command Query Responsibility Segregation)

```python
# Commands - –∏–∑–º–µ–Ω—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
class CreateUserCommand:
    def __init__(self, email: str, name: str):
        self.email = email
        self.name = name

class UpdateUserEmailCommand:
    def __init__(self, user_id: int, new_email: str):
        self.user_id = user_id
        self.new_email = new_email

# Queries - —á–∏—Ç–∞—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
class GetUserByIdQuery:
    def __init__(self, user_id: int):
        self.user_id = user_id

class GetUsersByEmailQuery:
    def __init__(self, email_pattern: str):
        self.email_pattern = email_pattern

# Command Handlers
class CreateUserCommandHandler:
    def __init__(self, 
                 user_repository: UserRepository,
                 email_service: EmailService):
        self.user_repository = user_repository
        self.email_service = email_service
    
    def handle(self, command: CreateUserCommand) -> int:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        existing = self.user_repository.find_by_email(command.email)
        if existing:
            raise ValueError("User already exists")
        
        # –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user = User(command.email, command.name)
        saved_user = self.user_repository.save(user)
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º welcome email
        self.email_service.send_welcome_email(saved_user.email)
        
        return saved_user.id

# Query Handlers
class GetUserByIdQueryHandler:
    def __init__(self, user_read_repository: UserReadRepository):
        self.user_read_repository = user_read_repository
    
    def handle(self, query: GetUserByIdQuery) -> Optional[UserDto]:
        return self.user_read_repository.find_by_id(query.user_id)

# Command/Query Bus
class CommandBus:
    def __init__(self):
        self.handlers = {}
    
    def register_handler(self, command_type: type, handler):
        self.handlers[command_type] = handler
    
    def execute(self, command):
        handler = self.handlers.get(type(command))
        if not handler:
            raise ValueError(f"No handler for {type(command)}")
        return handler.handle(command)

class QueryBus:
    def __init__(self):
        self.handlers = {}
    
    def register_handler(self, query_type: type, handler):
        self.handlers[query_type] = handler
    
    def execute(self, query):
        handler = self.handlers.get(type(query))
        if not handler:
            raise ValueError(f"No handler for {type(query)}")
        return handler.handle(query)

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CQRS
def test_create_user_command_handler():
    mock_repository = Mock()
    mock_repository.find_by_email.return_value = None
    mock_repository.save.return_value = User("test@example.com", "Test User")
    mock_repository.save.return_value.id = 123
    
    mock_email_service = Mock()
    
    handler = CreateUserCommandHandler(mock_repository, mock_email_service)
    command = CreateUserCommand("test@example.com", "Test User")
    
    user_id = handler.handle(command)
    
    assert user_id == 123
    mock_repository.save.assert_called_once()
    mock_email_service.send_welcome_email.assert_called_once_with("test@example.com")

def test_command_bus():
    mock_handler = Mock()
    mock_handler.handle.return_value = 123
    
    command_bus = CommandBus()
    command_bus.register_handler(CreateUserCommand, mock_handler)
    
    command = CreateUserCommand("test@example.com", "Test User")
    result = command_bus.execute(command)
    
    assert result == 123
    mock_handler.handle.assert_called_once_with(command)
```

## üõ†Ô∏è Dependency Injection –≤ TDD

### 1. –†—É—á–Ω–∞—è DI

```python
class ServiceContainer:
    def __init__(self):
        self._services = {}
        self._singletons = {}
    
    def register_transient(self, interface: type, implementation: type):
        self._services[interface] = implementation
    
    def register_singleton(self, interface: type, implementation: type):
        self._services[interface] = implementation
        self._singletons[interface] = None
    
    def get(self, interface: type):
        if interface in self._singletons:
            if self._singletons[interface] is None:
                self._singletons[interface] = self._create_instance(interface)
            return self._singletons[interface]
        
        return self._create_instance(interface)
    
    def _create_instance(self, interface: type):
        implementation = self._services[interface]
        # –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        return implementation()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
def setup_container() -> ServiceContainer:
    container = ServiceContainer()
    
    container.register_singleton(UserRepository, SQLAlchemyUserRepository)
    container.register_transient(EmailService, SMTPEmailService)
    container.register_transient(UserService, UserService)
    
    return container

def test_service_container():
    container = ServiceContainer()
    container.register_transient(EmailService, SMTPEmailService)
    
    service1 = container.get(EmailService)
    service2 = container.get(EmailService)
    
    assert isinstance(service1, SMTPEmailService)
    assert service1 is not service2  # Transient services
```

### 2. Dependency Injector Library

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ dependency-injector
uv add dependency-injector
```

```python
from dependency_injector import containers, providers
from dependency_injector.wiring import Provide, inject

# Container –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
class ApplicationContainer(containers.DeclarativeContainer):
    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    config = providers.Configuration()
    
    # Database
    database = providers.Singleton(
        Database,
        host=config.database.host,
        port=config.database.port,
    )
    
    # Repositories
    user_repository = providers.Factory(
        SQLAlchemyUserRepository,
        session=database.provided.session,
    )
    
    # Services
    email_service = providers.Factory(
        SMTPEmailService,
        host=config.email.smtp_host,
        port=config.email.smtp_port,
    )
    
    user_service = providers.Factory(
        UserService,
        user_repository=user_repository,
        email_service=email_service,
    )

# FastAPI —Å DI
@app.post("/users")
@inject
async def create_user(
    user_data: UserCreateRequest,
    user_service: UserService = Provide[ApplicationContainer.user_service]
):
    user = await user_service.create_user(user_data.email, user_data.name)
    return {"user_id": user.id}

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å override
def test_user_creation_with_di():
    container = ApplicationContainer()
    
    # Override –¥–ª—è —Ç–µ—Å—Ç–æ–≤
    mock_repository = Mock()
    mock_repository.save.return_value = User("test@example.com", "Test User")
    
    mock_email_service = Mock()
    
    with container.user_repository.override(mock_repository), \
         container.email_service.override(mock_email_service):
        
        user_service = container.user_service()
        user = user_service.create_user("test@example.com", "Test User")
        
        assert user.email == "test@example.com"
        mock_repository.save.assert_called_once()
```

## üß™ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```python
import ast
import os
from pathlib import Path

def test_domain_has_no_infrastructure_dependencies():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –¥–æ–º–µ–Ω –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã."""
    domain_path = Path("src/domain")
    
    for python_file in domain_path.glob("**/*.py"):
        with open(python_file, 'r', encoding='utf-8') as f:
            try:
                tree = ast.parse(f.read())
            except SyntaxError:
                continue
        
        for node in ast.walk(tree):
            if isinstance(node, ast.Import):
                for alias in node.names:
                    assert not alias.name.startswith('infrastructure'), \
                        f"Domain module {python_file} imports infrastructure: {alias.name}"
            
            elif isinstance(node, ast.ImportFrom):
                if node.module and node.module.startswith('infrastructure'):
                    raise AssertionError(
                        f"Domain module {python_file} imports from infrastructure: {node.module}"
                    )

def test_no_circular_dependencies():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π."""
    import_graph = {}
    
    def extract_imports(file_path):
        imports = set()
        with open(file_path, 'r', encoding='utf-8') as f:
            try:
                tree = ast.parse(f.read())
            except SyntaxError:
                return imports
        
        for node in ast.walk(tree):
            if isinstance(node, ast.ImportFrom) and node.module:
                if node.module.startswith('src.'):
                    imports.add(node.module)
        
        return imports
    
    # –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
    for root, dirs, files in os.walk('src'):
        for file in files:
            if file.endswith('.py'):
                file_path = os.path.join(root, file)
                module_name = file_path.replace('/', '.').replace('\\', '.').replace('.py', '')
                imports = extract_imports(file_path)
                import_graph[module_name] = imports
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ü–∏–∫–ª—ã (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
    def has_cycle(graph, start, visited, rec_stack):
        visited.add(start)
        rec_stack.add(start)
        
        for neighbor in graph.get(start, []):
            if neighbor in graph:
                if neighbor not in visited:
                    if has_cycle(graph, neighbor, visited, rec_stack):
                        return True
                elif neighbor in rec_stack:
                    return True
        
        rec_stack.remove(start)
        return False
    
    visited = set()
    for module in import_graph:
        if module not in visited:
            if has_cycle(import_graph, module, visited, set()):
                pytest.fail(f"Circular dependency detected involving {module}")
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

```python
def test_controllers_only_depend_on_use_cases():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –∑–∞–≤–∏—Å—è—Ç —Ç–æ–ª—å–∫–æ –æ—Ç use cases."""
    controllers_path = Path("src/controllers")
    
    for controller_file in controllers_path.glob("**/*.py"):
        with open(controller_file, 'r', encoding='utf-8') as f:
            content = f.read()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–µ—Ç –ø—Ä—è–º—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
        assert 'from src.infrastructure' not in content, \
            f"Controller {controller_file} directly imports infrastructure"
        
        assert 'from src.domain.repositories' not in content, \
            f"Controller {controller_file} directly imports repositories"

def test_use_cases_follow_single_responsibility():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ use cases —Å–ª–µ–¥—É—é—Ç –ø—Ä–∏–Ω—Ü–∏–ø—É –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏."""
    use_cases_path = Path("src/use_cases")
    
    for use_case_file in use_cases_path.glob("**/*.py"):
        with open(use_case_file, 'r', encoding='utf-8') as f:
            tree = ast.parse(f.read())
        
        class_count = 0
        method_count = 0
        
        for node in ast.walk(tree):
            if isinstance(node, ast.ClassDef):
                class_count += 1
                for item in node.body:
                    if isinstance(item, ast.FunctionDef) and not item.name.startswith('_'):
                        method_count += 1
        
        # –ö–∞–∂–¥—ã–π use case –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø—É–±–ª–∏—á–Ω—ã–π –º–µ—Ç–æ–¥
        if class_count > 0:
            assert method_count <= class_count, \
                f"Use case {use_case_file} has too many public methods (SRP violation)"

def test_entities_have_no_infrastructure_dependencies():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ entity –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã."""
    entities_path = Path("src/domain/entities")
    
    forbidden_imports = [
        'sqlalchemy',
        'django',
        'flask',
        'fastapi',
        'requests',
        'aiohttp'
    ]
    
    for entity_file in entities_path.glob("**/*.py"):
        with open(entity_file, 'r', encoding='utf-8') as f:
            content = f.read()
        
        for forbidden in forbidden_imports:
            assert forbidden not in content, \
                f"Entity {entity_file} has infrastructure dependency: {forbidden}"
```

## üéØ –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É—á–µ—Ç–æ–º —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏

### Design for Testability Principles

1. **–ò–∑–±–µ–≥–∞–π—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ dependency injection**
3. **–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –º–∞–ª–µ–Ω—å–∫–∏–µ, —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã**
4. **–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏—é –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é**
5. **–î–µ–ª–∞–π—Ç–µ –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã —è–≤–Ω—ã–º–∏**

```python
# –ü–ª–æ—Ö–æ - —Å–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
class OrderService:
    def process_order(self, order_data):
        # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
        db = Database.get_instance()
        email = EmailSender()
        logger = Logger.get_logger(__name__)
        
        # –°–∫—Ä—ã—Ç—ã–µ –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
        current_time = datetime.now()
        
        # –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
        if self._validate_order(order_data):
            order_id = db.save_order(order_data)
            email.send_confirmation(order_data['email'])
            logger.info(f"Order {order_id} processed at {current_time}")
            return order_id
        
        return None

# –•–æ—Ä–æ—à–æ - –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
class OrderValidator:
    def validate(self, order_data: dict) -> ValidationResult:
        errors = []
        if not order_data.get('customer_email'):
            errors.append("Email is required")
        if not order_data.get('items'):
            errors.append("Items are required")
        
        return ValidationResult(is_valid=len(errors) == 0, errors=errors)

class OrderService:
    def __init__(self, 
                 validator: OrderValidator,
                 repository: OrderRepository,
                 email_service: EmailService,
                 logger: Logger,
                 time_provider: TimeProvider):
        self.validator = validator
        self.repository = repository
        self.email_service = email_service
        self.logger = logger
        self.time_provider = time_provider
    
    def process_order(self, order_data: dict) -> ProcessOrderResult:
        # –Ø–≤–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
        validation = self.validator.validate(order_data)
        if not validation.is_valid:
            return ProcessOrderResult.failure(validation.errors)
        
        # –Ø–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
        order = Order.from_dict(order_data)
        order.processed_at = self.time_provider.now()
        
        saved_order = self.repository.save(order)
        
        self.email_service.send_confirmation(order.customer_email, saved_order.id)
        self.logger.info(f"Order {saved_order.id} processed at {order.processed_at}")
        
        return ProcessOrderResult.success(saved_order.id)

# –õ–µ–≥–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
def test_order_service_successful_processing():
    # Arrange
    mock_validator = Mock()
    mock_validator.validate.return_value = ValidationResult(is_valid=True, errors=[])
    
    mock_repository = Mock()
    mock_repository.save.return_value = Order(id=123, customer_email="test@example.com")
    
    mock_email_service = Mock()
    mock_logger = Mock()
    
    mock_time_provider = Mock()
    mock_time_provider.now.return_value = datetime(2024, 8, 26, 12, 0, 0)
    
    service = OrderService(
        mock_validator, 
        mock_repository, 
        mock_email_service, 
        mock_logger,
        mock_time_provider
    )
    
    order_data = {"customer_email": "test@example.com", "items": [{"id": 1}]}
    
    # Act
    result = service.process_order(order_data)
    
    # Assert
    assert result.is_successful
    assert result.order_id == 123
    
    mock_validator.validate.assert_called_once_with(order_data)
    mock_repository.save.assert_called_once()
    mock_email_service.send_confirmation.assert_called_once_with("test@example.com", 123)
    mock_logger.info.assert_called_once()
```

## üèÜ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã TDD

1. **Dependency Inversion** ‚Äî –∑–∞–≤–∏—Å—å—Ç–µ –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π
2. **Single Responsibility** ‚Äî –æ–¥–∏–Ω –∫–ª–∞—Å—Å = –æ–¥–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. **Interface Segregation** ‚Äî –º–Ω–æ–≥–æ –º–∞–ª–µ–Ω—å–∫–∏—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
4. **Composition over Inheritance** ‚Äî –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏—é
5. **Explicit Dependencies** ‚Äî –¥–µ–ª–∞–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —è–≤–Ω—ã–º–∏
6. **Pure Functions** ‚Äî –∏–∑–±–µ–≥–∞–π—Ç–µ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

### ‚ùå –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã

1. **God Object** ‚Äî –∫–ª–∞—Å—Å—ã, –¥–µ–ª–∞—é—â–∏–µ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ
2. **Tight Coupling** ‚Äî –∂–µ—Å—Ç–∫–∏–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
3. **Hidden Dependencies** ‚Äî —Å–∫—Ä—ã—Ç—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
4. **Mixed Concerns** ‚Äî —Å–º–µ—à–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏
5. **Testing Implementation Details** ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤

## üîÆ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

TDD –Ω–µ –ø—Ä–æ—Å—Ç–æ —É–ª—É—á—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤ ‚Äî –æ–Ω —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è:

- **–õ–µ–≥–∫–æ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è** –ø—Ä–∏ –Ω–æ–≤—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö
- **–•–æ—Ä–æ—à–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è** –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- **–ü–æ–Ω—è—Ç–Ω–∞** –Ω–æ–≤—ã–º —á–ª–µ–Ω–∞–º –∫–æ–º–∞–Ω–¥—ã
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è** —Å —Ä–æ—Å—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–∞
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è** –≤ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ

–°–ª–µ–¥—É—è –ø—Ä–∏–Ω—Ü–∏–ø–∞–º TDD –∏ –ø—Ä–∏–º–µ–Ω—è—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –≤—ã —Å–æ–∑–¥–∞–µ—Ç–µ —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ä–∞–¥–æ–≤–∞—Ç—å –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –º–Ω–æ–≥–∏—Ö –ª–µ—Ç.

## üß™ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è

<div class="quiz-container" id="tdd-architecture-quiz">
<script type="application/json">
{
  "title": "TDD –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",
  "description": "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤–ª–∏—è–Ω–∏—è TDD –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã",
  "icon": "üèóÔ∏è",
  "questions": [
    {
      "question": "–ö–∞–∫ TDD –≤–ª–∏—è–µ—Ç –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è?",
      "type": "multiple",
      "options": [
        {"text": "–°–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç —Å–ª–∞–±–æ–π —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤", "correct": true},
        {"text": "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç coupling –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏", "correct": false},
        {"text": "–°–Ω–∏–∂–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã", "correct": false},
        {"text": "–ü–æ–≤—ã—à–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º", "correct": true},
        {"text": "–£—Å–ª–æ–∂–Ω—è–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π", "correct": false}
      ],
      "explanation": "TDD –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≤–µ–¥–µ—Ç –∫ —Å–ª–∞–±–æ–π —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –∏ –≤—ã—Å–æ–∫–æ–π –≥–∏–±–∫–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç Dependency Injection –∏ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π.",
      "points": 2
    },
    {
      "question": "–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø Single Responsibility Principle (SRP)?",
      "type": "single",
      "options": [
        {"text": "–ö–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –ø—Ä–∏—á–∏–Ω—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è", "correct": true},
        {"text": "–ö–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –æ—Ç –æ–¥–Ω–æ–≥–æ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞", "correct": false},
        {"text": "–ö–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –º–µ—Ç–æ–¥", "correct": false},
        {"text": "–ö–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–µ–Ω –∑–∞ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏", "correct": false}
      ],
      "explanation": "SRP –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ –æ–¥–Ω—É –ø—Ä–∏—á–∏–Ω—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è.",
      "points": 1
    },
    {
      "question": "–ß—Ç–æ —Ç–∞–∫–æ–µ Dependency Inversion Principle (DIP)?",
      "type": "single",
      "options": [
        {"text": "–í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –º–æ–¥—É–ª–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö", "correct": true},
        {"text": "–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∂–µ—Å—Ç–∫–æ —Å–≤—è–∑–∞–Ω—ã", "correct": false},
        {"text": "–í—Å–µ –º–æ–¥—É–ª–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π", "correct": false},
        {"text": "–ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –º–æ–¥—É–ª–∏ –¥–æ–ª–∂–Ω—ã —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–º–∏", "correct": false}
      ],
      "explanation": "DIP —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –º–æ–¥—É–ª–∏ –∑–∞–≤–∏—Å–µ–ª–∏ –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π, –∞ –Ω–µ –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å.",
      "points": 1
    },
    {
      "question": "–ö–∞–∫–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ö–æ—Ä–æ—à–æ —Å–æ—á–µ—Ç–∞—é—Ç—Å—è —Å TDD? (–≤—ã–±–µ—Ä–∏—Ç–µ –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ)",
      "type": "multiple",
      "options": [
        {"text": "Hexagonal Architecture (Ports & Adapters)", "correct": true},
        {"text": "CQRS (Command Query Responsibility Segregation)", "correct": true},
        {"text": "Big Ball of Mud", "correct": false},
        {"text": "Event Sourcing", "correct": true},
        {"text": "God Object Pattern", "correct": false}
      ],
      "explanation": "Hexagonal Architecture, CQRS –∏ Event Sourcing —Å–ø–æ—Å–æ–±—Å—Ç–≤—É—é—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–µ–π –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤.",
      "points": 2
    },
    {
      "question": "–ß—Ç–æ —Ç–∞–∫–æ–µ Ports & Adapters –≤ Hexagonal Architecture?",
      "type": "single",
      "options": [
        {"text": "Ports - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, Adapters - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º", "correct": true},
        {"text": "Ports - —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑—ä–µ–º—ã, Adapters - –ø–µ—Ä–µ—Ö–æ–¥–Ω–∏–∫–∏", "correct": false},
        {"text": "Ports - —Å–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ, Adapters - –∞–¥–∞–ø—Ç–µ—Ä—ã —Å–µ—Ç–∏", "correct": false},
        {"text": "Ports - –ø–æ—Ä—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞, Adapters - —Å–µ—Ç–µ–≤—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã", "correct": false}
      ],
      "explanation": "–í Hexagonal Architecture Ports –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –≤–Ω–µ—à–Ω–∏–º –º–∏—Ä–æ–º, –∞ Adapters –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.",
      "points": 1
    },
    {
      "question": "–ö–∞–∫–æ–π –∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω –ù–ï —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç TDD?",
      "type": "single",
      "options": [
        {"text": "God Object - –∫–ª–∞—Å—Å, –¥–µ–ª–∞—é—â–∏–π —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ", "correct": true},
        {"text": "Dependency Injection", "correct": false},
        {"text": "Interface Segregation", "correct": false},
        {"text": "Single Responsibility", "correct": false}
      ],
      "explanation": "God Object (–∫–ª–∞—Å—Å, –¥–µ–ª–∞—é—â–∏–π —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ) —É—Å–ª–æ–∂–Ω—è–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º TDD.",
      "points": 1
    }
  ]
}
</script>
</div>

---

**–ü—Ä–µ–¥—ã–¥—É—â–∞—è –≥–ª–∞–≤–∞:** [–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ](18_advanced_mocking.md)
**–°–ª–µ–¥—É—é—â–∞—è –≥–ª–∞–≤–∞:** [–ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∏ —Ä–µ—Å—É—Ä—Å—ã](20_conclusion.md)

*üèóÔ∏è –ü–æ–º–Ω–∏—Ç–µ: —Ö–æ—Ä–æ—à–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚Äî —ç—Ç–æ –Ω–µ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å, —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç—ã!*
